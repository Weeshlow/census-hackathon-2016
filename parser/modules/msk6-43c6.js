/*
    NOTE: ALL POSITION VALUES ARE INCORRECT, THE FIRST 8 ROWS CONTAIN METADATA

    [{
      "id" : 159006339,
      "name" : "PermitNumber",
      "dataTypeName" : "text",
      "fieldName" : "permitnumber",
      "position" : 1,
      "renderTypeName" : "text",
      "tableColumnId" : 9219292,
      "width" : 244,

    }, {
      "id" : 159006340,
      "name" : "WORKTYPE",
      "dataTypeName" : "text",
      "fieldName" : "worktype",
      "position" : 2,
      "renderTypeName" : "text",
      "tableColumnId" : 9219294,
      "width" : 196,

    }, {
      "id" : 159006341,
      "name" : "PermitTypeDescr",
      "dataTypeName" : "text",
      "fieldName" : "permittypedescr",
      "position" : 3,
      "renderTypeName" : "text",
      "tableColumnId" : 9219296,
      "width" : 280,

    }, {
      "id" : 159006342,
      "name" : "DESCRIPTION",
      "dataTypeName" : "text",
      "fieldName" : "description",
      "position" : 4,
      "renderTypeName" : "text",
      "tableColumnId" : 9219298,
      "width" : 232,

    }, {
      "id" : 159006343,
      "name" : "Comments",
      "dataTypeName" : "text",
      "fieldName" : "comments",
      "position" : 5,
      "renderTypeName" : "text",
      "tableColumnId" : 20248355,
      "width" : 100,

    }, {
      "id" : 159006344,
      "name" : "APPLICANT",
      "dataTypeName" : "text",
      "fieldName" : "applicant",
      "position" : 6,
      "renderTypeName" : "text",
      "tableColumnId" : 9219301,
      "width" : 208,

    }, {
      "id" : 159006345,
      "name" : "DECLARED_VALUATION",
      "dataTypeName" : "money",
      "fieldName" : "declared_valuation",
      "position" : 7,
      "renderTypeName" : "money",
      "tableColumnId" : 9219305,
      "width" : 316,

    }, {
      "id" : 159006346,
      "name" : "TOTAL_FEES",
      "dataTypeName" : "money",
      "fieldName" : "total_fees",
      "position" : 8,
      "renderTypeName" : "money",
      "tableColumnId" : 9219308,
      "width" : 220,

    }, {
      "id" : 159006347,
      "name" : "ISSUED_DATE",
      "dataTypeName" : "calendar_date",
      "fieldName" : "issued_date",
      "position" : 9,
      "renderTypeName" : "calendar_date",
      "tableColumnId" : 9219311,
      "width" : 232,

    }, {
      "id" : 159006348,
      "name" : "EXPIRATION_DATE",
      "dataTypeName" : "calendar_date",
      "fieldName" : "expiration_date",
      "position" : 10,
      "renderTypeName" : "calendar_date",
      "tableColumnId" : 9219313,
      "width" : 280,

    }, {
      "id" : 159006349,
      "name" : "STATUS",
      "dataTypeName" : "text",
      "fieldName" : "status",
      "position" : 11,
      "renderTypeName" : "text",
      "tableColumnId" : 9219316,
      "width" : 172,

    }, {
      "id" : 159006350,
      "name" : "OWNER",
      "dataTypeName" : "text",
      "fieldName" : "owner",
      "position" : 12,
      "renderTypeName" : "text",
      "tableColumnId" : 9219318,
      "width" : 160,

    }, {
      "id" : 159006351,
      "name" : "OCCUPANCYTYPE",
      "dataTypeName" : "text",
      "fieldName" : "occupancytype",
      "position" : 13,
      "renderTypeName" : "text",
      "tableColumnId" : 9219321,
      "width" : 256,

    }, {
      "id" : 159006352,
      "name" : "Sq_feet",
      "dataTypeName" : "number",
      "fieldName" : "sq_feet",
      "position" : 14,
      "renderTypeName" : "number",
      "tableColumnId" : 18228256,
      "width" : 100,

    }, {
      "id" : 159006353,
      "name" : "ADDRESS",
      "dataTypeName" : "text",
      "fieldName" : "address",
      "position" : 15,
      "renderTypeName" : "text",
      "tableColumnId" : 9219322,
      "width" : 184,

    }, {
      "id" : 159006354,
      "name" : "CITY",
      "dataTypeName" : "text",
      "fieldName" : "city",
      "position" : 16,
      "renderTypeName" : "text",
      "tableColumnId" : 9219323,
      "width" : 148,

    }, {
      "id" : 159006355,
      "name" : "STATE",
      "dataTypeName" : "text",
      "fieldName" : "state",
      "position" : 17,
      "renderTypeName" : "text",
      "tableColumnId" : 9219324,
      "width" : 160,

    }, {
      "id" : 159006356,
      "name" : "ZIP",
      "dataTypeName" : "text",
      "fieldName" : "zip",
      "position" : 18,
      "renderTypeName" : "text",
      "tableColumnId" : 9219325,
      "width" : 136,

    }, {
      "id" : 159006357,
      "name" : "Property_ID",
      "dataTypeName" : "text",
      "fieldName" : "property_id",
      "position" : 19,
      "renderTypeName" : "text",
      "tableColumnId" : 14630478,
      "width" : 100,

    }, {
      "id" : 159006390,
      "name" : "Parcel_ID",
      "dataTypeName" : "text",
      "fieldName" : "parcel_id",
      "position" : 20,
      "renderTypeName" : "text",
      "tableColumnId" : 21005707,
      "width" : 100,

    }, {
      "id" : 159006358,
      "name" : "Location",
      "dataTypeName" : "location",
      "fieldName" : "location",
      "position" : 21,
      "renderTypeName" : "location",
      "tableColumnId" : 9219326,
      "width" : 196,
      "subColumnTypes" : [ "human_address", "latitude", "longitude", "machine_address", "needs_recoding" ]
  }]
*/

/*
    SAMPLE ROW
    {
      0: 285811,
      1: "51BA2988-F87B-47F6-A3A6-7F01C6C5079A",
      2: 285811,
      3: 1409069386,
      4: "525314",
      5: 1409069386,
      6: "525314",
      7: null,
      8: "U497392",
      9: "CONVRT",
      10: "Use of Premises",
      11: "From TimeMatters-PZ Conversion",
      12: "Proposed Work: Two vehicle parking  Last Action: READY TO ISSUE",
      13: null,
      14: "0",
      15: "0",
      16: "2006-09-26T00:00:00",
      17: "2014-01-29T00:00:00",
      18: "EXPIRED",
      19: null,
      20: "1-3FAM",
      21: "0",
      22: "93    Sydney ST",
      23: "Dorchester",
      24: "MA",
      25: "02125",
      26: "317194",
      27: null,
      28: [ null, "42.31465", "-71.05243", null, false ]
    }
*/

(function() {
  'use strict';

  const CENTS_MULTIPLIER = 100;

  const TYPE_COL = 9;
  const LAT_COL = 28;
  const LON_COL = 28;
  const DATE_COL = 16;
  const DESC_COL = 11;
  const AMOUNT_COL = 8;

  module.exports = function(id) {
    return {
      id: () => id,
      type: (arr) => arr[TYPE_COL],
      status: () => null,
      latitude: (arr) => arr[LAT_COL] ? arr[LAT_COL][1] : null,
      longitude: (arr) => arr[LON_COL] ? arr[LON_COL][2] : null,
      units: () => null,
      timestamp: (arr) => arr[DATE_COL],
      description: (arr) => arr[DESC_COL] ? arr[DESC_COL].trim() : null,
      amount: (arr) => arr[AMOUNT_COL] * CENTS_MULTIPLIER
    };
  };

}());
