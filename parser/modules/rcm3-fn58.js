/*
    NOTE: ALL POSITION VALUES ARE INCORRECT, THE FIRST 8 ROWS CONTAIN METADATA

    [{
      "id" : 175326064,
      "name" : "Address",
      "dataTypeName" : "text",
      "fieldName" : "address",
      "position" : 1,
      "renderTypeName" : "text",
      "tableColumnId" : 7988342,
      "width" : 184,

    }, {
      "id" : 175326065,
      "name" : "Owner",
      "dataTypeName" : "text",
      "fieldName" : "owner",
      "position" : 2,
      "renderTypeName" : "text",
      "tableColumnId" : 7988326,
      "width" : 160,

    }, {
      "id" : 175326066,
      "name" : "Description",
      "dataTypeName" : "text",
      "fieldName" : "description",
      "position" : 3,
      "renderTypeName" : "text",
      "tableColumnId" : 7988339,
      "width" : 232,

    }, {
      "id" : 175326067,
      "name" : "NumString",
      "dataTypeName" : "text",
      "fieldName" : "numstring",
      "position" : 4,
      "renderTypeName" : "text",
      "tableColumnId" : 7988301,
      "width" : 208,

    }, {
      "id" : 175326068,
      "name" : "IsClosed",
      "dataTypeName" : "text",
      "fieldName" : "isclosed",
      "position" : 5,
      "renderTypeName" : "text",
      "tableColumnId" : 7988302,
      "width" : 196,

    }, {
      "id" : 175326069,
      "name" : "Type",
      "dataTypeName" : "text",
      "fieldName" : "type",
      "position" : 6,
      "renderTypeName" : "text",
      "tableColumnId" : 7988303,
      "width" : 148,

    }, {
      "id" : 175326070,
      "name" : "Code",
      "dataTypeName" : "text",
      "fieldName" : "code",
      "position" : 7,
      "renderTypeName" : "text",
      "tableColumnId" : 7988304,
      "width" : 148,

    }, {
      "id" : 175326071,
      "name" : "Division",
      "dataTypeName" : "text",
      "fieldName" : "division",
      "position" : 8,
      "renderTypeName" : "text",
      "tableColumnId" : 7988305,
      "width" : 196,

    }, {
      "id" : 175326072,
      "name" : "M_S",
      "dataTypeName" : "text",
      "fieldName" : "m_s",
      "position" : 9,
      "renderTypeName" : "text",
      "tableColumnId" : 7988306,
      "width" : 136,

    }, {
      "id" : 175326073,
      "name" : "FilingDate",
      "dataTypeName" : "calendar_date",
      "fieldName" : "filingdate",
      "position" : 10,
      "renderTypeName" : "calendar_date",
      "tableColumnId" : 7988307,
      "width" : 220,

    }, {
      "id" : 175326074,
      "name" : "IssueDate",
      "dataTypeName" : "calendar_date",
      "fieldName" : "issuedate",
      "position" : 11,
      "renderTypeName" : "calendar_date",
      "tableColumnId" : 7988308,
      "width" : 208,

    }, {
      "id" : 175326075,
      "name" : "CurrentStatus",
      "dataTypeName" : "text",
      "fieldName" : "currentstatus",
      "position" : 12,
      "renderTypeName" : "text",
      "tableColumnId" : 7988309,
      "width" : 256,
    }, {
      "id" : 175326076,
      "name" : "NextStatus",
      "dataTypeName" : "text",
      "fieldName" : "nextstatus",
      "position" : 13,
      "renderTypeName" : "text",
      "tableColumnId" : 7988310,
      "width" : 220,

    }, {
      "id" : 175326077,
      "name" : "CurrentStatusDate",
      "dataTypeName" : "calendar_date",
      "fieldName" : "currentstatusdate",
      "position" : 14,
      "renderTypeName" : "calendar_date",
      "tableColumnId" : 7988311,
      "width" : 304,

    }, {
      "id" : 175326078,
      "name" : "NextStatusDate",
      "dataTypeName" : "calendar_date",
      "fieldName" : "nextstatusdate",
      "position" : 15,
      "renderTypeName" : "calendar_date",
      "tableColumnId" : 7988312,
      "width" : 268,

    }, {
      "id" : 175326079,
      "name" : "LandUse",
      "dataTypeName" : "text",
      "fieldName" : "landuse",
      "position" : 16,
      "renderTypeName" : "text",
      "tableColumnId" : 7988313,
      "width" : 184,

    }, {
      "id" : 175326080,
      "name" : "LandUseShort",
      "dataTypeName" : "text",
      "fieldName" : "landuseshort",
      "position" : 17,
      "renderTypeName" : "text",
      "tableColumnId" : 7988314,
      "width" : 244,

    }, {
      "id" : 175326081,
      "name" : "ProjectName",
      "dataTypeName" : "text",
      "fieldName" : "projectname",
      "position" : 18,
      "renderTypeName" : "text",
      "tableColumnId" : 7988315,
      "width" : 232,

    }, {
      "id" : 175326082,
      "name" : "UnpaidFees",
      "dataTypeName" : "number",
      "fieldName" : "unpaidfees",
      "position" : 19,
      "renderTypeName" : "number",
      "tableColumnId" : 7988316,
      "width" : 220,

    }, {
      "id" : 175326083,
      "name" : "TotalFees",
      "dataTypeName" : "number",
      "fieldName" : "totalfees",
      "position" : 20,
      "renderTypeName" : "number",
      "tableColumnId" : 7988317,
      "width" : 208,

    }, {
      "id" : 175326084,
      "name" : "BldgArea",
      "dataTypeName" : "number",
      "fieldName" : "bldgarea",
      "position" : 21,
      "renderTypeName" : "number",
      "tableColumnId" : 7988318,
      "width" : 196,

    }, {
      "id" : 175326085,
      "name" : "ConstrVal",
      "dataTypeName" : "number",
      "fieldName" : "constrval",
      "position" : 22,
      "renderTypeName" : "number",
      "tableColumnId" : 7988319,
      "width" : 208,

    }, {
      "id" : 175326086,
      "name" : "BondAmount",
      "dataTypeName" : "number",
      "fieldName" : "bondamount",
      "position" : 23,
      "renderTypeName" : "number",
      "tableColumnId" : 7988320,
      "width" : 220,

    }, {
      "id" : 175326088,
      "name" : "OpenComments",
      "dataTypeName" : "number",
      "fieldName" : "opencomments",
      "position" : 24,
      "renderTypeName" : "number",
      "tableColumnId" : 7988321,
      "width" : 244,

    }, {
      "id" : 175326089,
      "name" : "Applicant",
      "dataTypeName" : "text",
      "fieldName" : "applicant",
      "position" : 25,
      "renderTypeName" : "text",
      "tableColumnId" : 7988322,
      "width" : 208,

    }, {
      "id" : 175326090,
      "name" : "TotalInspections",
      "dataTypeName" : "number",
      "fieldName" : "totalinspections",
      "position" : 26,
      "renderTypeName" : "number",
      "tableColumnId" : 7988323,
      "width" : 292,

    }, {
      "id" : 175326091,
      "name" : "Contractors",
      "dataTypeName" : "text",
      "fieldName" : "contractors",
      "position" : 27,
      "renderTypeName" : "text",
      "tableColumnId" : 7988324,
      "width" : 232,

    }, {
      "id" : 175326092,
      "name" : "PIN",
      "dataTypeName" : "text",
      "fieldName" : "pin",
      "position" : 28,
      "renderTypeName" : "text",
      "tableColumnId" : 7988325,
      "width" : 136,

    }, {
      "id" : 175326093,
      "name" : "Beds",
      "dataTypeName" : "number",
      "fieldName" : "beds",
      "position" : 29,
      "renderTypeName" : "number",
      "tableColumnId" : 7988327,
      "width" : 148,

    }, {
      "id" : 175326094,
      "name" : "Baths",
      "dataTypeName" : "number",
      "fieldName" : "baths",
      "position" : 30,
      "renderTypeName" : "number",
      "tableColumnId" : 7988328,
      "width" : 160,

    }, {
      "id" : 175326095,
      "name" : "HeatType",
      "dataTypeName" : "text",
      "fieldName" : "heattype",
      "position" : 31,
      "renderTypeName" : "text",
      "tableColumnId" : 7988329,
      "width" : 196,

    }, {
      "id" : 175326096,
      "name" : "SecondFloo",
      "dataTypeName" : "number",
      "fieldName" : "secondfloo",
      "position" : 32,
      "renderTypeName" : "number",
      "tableColumnId" : 7988330,
      "width" : 220,

    }, {
      "id" : 175326097,
      "name" : "BasementAr",
      "dataTypeName" : "number",
      "fieldName" : "basementar",
      "position" : 33,
      "renderTypeName" : "number",
      "tableColumnId" : 7988331,
      "width" : 220,

    }, {
      "id" : 175326098,
      "name" : "DaysOpen",
      "dataTypeName" : "number",
      "fieldName" : "daysopen",
      "position" : 34,
      "renderTypeName" : "number",
      "tableColumnId" : 7988332,
      "width" : 196,

    }, {
      "id" : 175326099,
      "name" : "DaysIssued",
      "dataTypeName" : "number",
      "fieldName" : "daysissued",
      "position" : 35,
      "renderTypeName" : "number",
      "tableColumnId" : 7988333,
      "width" : 220,

    }, {
      "id" : 175326100,
      "name" : "LeadAgency",
      "dataTypeName" : "text",
      "fieldName" : "leadagency",
      "position" : 36,
      "renderTypeName" : "text",
      "tableColumnId" : 7988334,
      "width" : 220,

    }, {
      "id" : 175326101,
      "name" : "ExitReason",
      "dataTypeName" : "text",
      "fieldName" : "exitreason",
      "position" : 37,
      "renderTypeName" : "text",
      "tableColumnId" : 7988335,
      "width" : 220,
    }, {
      "id" : 175326102,
      "name" : "Subdivision",
      "dataTypeName" : "text",
      "fieldName" : "subdivision",
      "position" : 38,
      "renderTypeName" : "text",
      "tableColumnId" : 7988336,
      "width" : 232,

    }, {
      "id" : 175326103,
      "name" : "CouncilDist",
      "dataTypeName" : "text",
      "fieldName" : "councildist",
      "position" : 39,
      "renderTypeName" : "text",
      "tableColumnId" : 7988337,
      "width" : 232,

    }, {
      "id" : 175326104,
      "name" : "Zoning",
      "dataTypeName" : "text",
      "fieldName" : "zoning",
      "position" : 40,
      "renderTypeName" : "text",
      "tableColumnId" : 7988338,
      "width" : 172,

    }, {
      "id" : 175326105,
      "name" : "HistoricDistrict",
      "dataTypeName" : "text",
      "fieldName" : "historicdistrict",
      "position" : 41,
      "renderTypeName" : "text",
      "tableColumnId" : 7988340,
      "width" : 292,

    }, {
      "id" : 175326106,
      "name" : "Location 1",
      "dataTypeName" : "location",
      "fieldName" : "location_1",
      "position" : 42,
      "renderTypeName" : "location",
      "tableColumnId" : 7988341,
      "width" : 220,
      "subColumnTypes" : [ "human_address", "latitude", "longitude", "machine_address", "needs_recoding" ]
    }]
*/

/*
    SAMPLE ROW
    {
      0: 3,
      1: "D9AC1441-056D-4CA7-A5B0-D141BE932FC2",
      2: 3,
      3: 1415829015,
      4: "394413",
      5: 1415829896,
      6: "394413",
      7: null,
      8: "2929 Leonidas St",
      9: null,
      10: "Work Descripton: HURRICANE DAMAGE REPAIR - SHEETROCK,ELECTRICAL,MECHANICAL,CABINETS,DOORS (2929-29 A Leonidas st).\r\n\r\nHistorical Import Type: Permits Residential Single (One-Family Unit) Emergency Permit\r\nUser: EBROWN\r\nTracking: \r\nStatus: Permit Issuance Active\r\nStatus Date: 12/12/2005 12:00:00 AM\r\n\r\nOwner: Ruby C Morgan\r\nOwner Address: 2929 Leonidas St, New Orleans, LA\r\nOwner Phone: 8665696\r\nOwner Edited By: 12/12/2005 by EBROWN",
      11: "05BLD-05127",
      12: "true",
      13: "Emergency Permit",
      14: "EMER",
      15: "SP",
      16: "M",
      17: "2006-01-11T00:00:00",
      18: "2013-12-23T00:00:00",
      19: "Certificate of Occupancy",
      20: null,
      21: "2014-01-07T00:00:00",
      22: null,
      23: "Two-Family",
      24: "RSF2",
      25: null,
      26: "50.0",
      27: "150.0",
      28: "0",
      29: "10000",
      30: "0.0",
      31: "0",
      32: "Ruby Morgan",
      33: "2",
      34: null,
      35: null,
      36: "0",
      37: "0.0",
      38: null,
      39: "0",
      40: "0",
      41: "2918",
      42: "15",
      43: "City of New Orleans",
      44: "Finaled",
      45: null,
      46: null,
      47: null,
      48: null,
      49: [ null, "29.96339473253953", "-90.12028369329056", null, false ]
    }
*/

(function() {
    'use strict';

    const CENTS_MULTIPLIER = 100;

    const TYPE_COL = 13;
    const LAT_COL = 49;
    const LON_COL = 49;
    const DATE_COL = 17;
    const DESC_COL = 10;
    const AMOUNT_COL = 27;

    module.exports = function(id) {
        return {
            id: () => id,
            type: (arr) => arr[TYPE_COL],
            status: () => null,
            latitude: (arr) => arr[LAT_COL] ? arr[LAT_COL][1] : null,
            longitude: (arr) => arr[LON_COL] ? arr[LON_COL][2] : null,
            units: () => null,
            timestamp: (arr) => arr[DATE_COL],
            description: (arr) => arr[DESC_COL] ? arr[DESC_COL].trim() : null,
            amount: (arr) => arr[AMOUNT_COL] * CENTS_MULTIPLIER
        };
    };

}());
